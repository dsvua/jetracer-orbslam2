[{"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/index.js":"1","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/App.js":"2","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/reportWebVitals.js":"3","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/components/connection.jsx":"4","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/message/index.js":"5","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/network/index.js":"6","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/message/parseMessage.js":"7","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/network/selectors.js":"8","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/network/atoms.js":"9","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/hooks/useWebsockets.js":"10","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/video/index.js":"11","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/video/selectors.js":"12","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/video/atoms.js":"13","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/components/videofeed.jsx":"14"},{"size":581,"mtime":1612056821621,"results":"15","hashOfConfig":"16"},{"size":1315,"mtime":1612327331298,"results":"17","hashOfConfig":"16"},{"size":362,"mtime":1611851068822,"results":"18","hashOfConfig":"16"},{"size":1963,"mtime":1612323101547,"results":"19","hashOfConfig":"16"},{"size":31,"mtime":1612054968878,"results":"20","hashOfConfig":"16"},{"size":53,"mtime":1612052472494,"results":"21","hashOfConfig":"16"},{"size":711,"mtime":1612321187157,"results":"22","hashOfConfig":"16"},{"size":228,"mtime":1612052441766,"results":"23","hashOfConfig":"16"},{"size":386,"mtime":1612057107971,"results":"24","hashOfConfig":"16"},{"size":2194,"mtime":1612329789758,"results":"25","hashOfConfig":"16"},{"size":53,"mtime":1612320795584,"results":"26","hashOfConfig":"16"},{"size":222,"mtime":1612322761666,"results":"27","hashOfConfig":"16"},{"size":294,"mtime":1612327450739,"results":"28","hashOfConfig":"16"},{"size":2176,"mtime":1612329948570,"results":"29","hashOfConfig":"16"},{"filePath":"30","messages":"31","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},"10jqpiy",{"filePath":"33","messages":"34","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"35","usedDeprecatedRules":"32"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"38"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"41","usedDeprecatedRules":"32"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"45","messages":"46","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"47","messages":"48","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"49","usedDeprecatedRules":"44"},{"filePath":"50","messages":"51","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"52","usedDeprecatedRules":"32"},{"filePath":"53","messages":"54","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"55","usedDeprecatedRules":"32"},{"filePath":"56","messages":"57","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"58","usedDeprecatedRules":"32"},{"filePath":"59","messages":"60","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"61","messages":"62","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"63","messages":"64","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"65","usedDeprecatedRules":"66"},{"filePath":"67","messages":"68","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"69","usedDeprecatedRules":"32"},"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/index.js",[],["70","71"],"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/App.js",["72"],"import './App.css';\nimport { WsConnection } from './components/connection';\nimport React, {useState, useEffect} from \"react\";\nimport useWebsocket from \"./hooks/useWebsockets\";\nimport { VideoFeed } from \"./components/videofeed\";\n\nfunction getWindowDimensions() {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n      width,\n      height\n  };\n}\n\nconst App = () => {\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\n\n  useWebsocket();\n\n  function handleResize() {\n    // console.log(\"before resize\", getWindowDimensions());\n    setWindowDimensions(getWindowDimensions());\n    // console.log(\"after resize\", getWindowDimensions());\n  }\n\n  useEffect(() => {\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  return (\n      <div className=\"container-fluid d-flex flex-column min-vh-100 h-100 w-100\">\n        <div className=\"row align-items-start w-100\">\n          {/* <div className=\"col\"> */}\n            <VideoFeed />        \n          {/* </div> */}\n        </div>\n        {/* <div className=\"row align-items-end w-100\">\n          <div className=\"col\"> */}\n            <WsConnection />        \n          {/* </div>\n        </div> */}\n      </div>\n  );\n}\n\nexport default App;\n","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/reportWebVitals.js",[],["73","74"],"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/components/connection.jsx",["75","76"],"import React, { useState, useEffect } from 'react';\nimport { useRecoilState, useRecoilValue } from 'recoil';\nimport { connectionStateUrl, connectionStateIsConnected, connectionStateWs } from '../state/network'\n\nexport const WsConnection = () => {\n\n    const [connUrl, setConnUrl] = useRecoilState(connectionStateUrl);\n    const isConnected = useRecoilValue(connectionStateIsConnected);\n    const [ws, setWs] = useRecoilState(connectionStateWs);\n\n    const handleUrlChange = (e) => {\n        setConnUrl(e.target.value);\n    };\n\n    const handleConnect = (e) => {\n\n        if(!isConnected) {\n            setWs(new WebSocket(connUrl));\n        } else {\n            ws.close();\n        };\n    };\n\n    const handleSendTextMessage = (e) => {\n        ws.send('{\"message\": \"test message\"}');\n    };\n\n    return (\n        // <div>\n        //     <div className=\"container w-100\">\n                <div className=\"row justify-content-center align-items-end\">\n                    <div className=\"col justify-content-center\">\n                        <input type=\"text\" value={connUrl} onChange={handleUrlChange}>\n                        </input>\n                    </div>\n                    <div className=\"col justify-content-center\">\n                        <button onClick={handleConnect}\n                        type=\"button\"\n                        className={isConnected ? \"btn btn-warning\" : \"btn btn-success\"}> \n                            {isConnected ? \"Disconnect\" : \"Connect\"}\n                        </button>\n                    </div>\n                    <div className=\"col justify-content-center\">\n                        <button disabled={!isConnected} onClick={handleSendTextMessage}\n                        type=\"button\"\n                        className=\"btn btn-secondary\"> \n                            Send Text message\n                        </button>\n                    </div>\n                </div>\n        //     </div>\n        // </div>\n    )\n}","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/message/index.js",[],["77","78"],"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/network/index.js",[],"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/message/parseMessage.js",["79"],"import BSON from 'bson';\nimport { useRecoilState } from 'recoil';\nimport { videoImage as VideoImage } from '../state/video'\n\nexport const useParseMessage = (message) => {\n\n    const [videoImage, setVideoImage] = useRecoilState(VideoImage);\n\n\n    try {\n        const reader = new FileReader()\n        reader.onload = function () {\n          const msgarray = new Uint8Array(this.result)\n          const msg = BSON.deserialize(msgarray)\n          setVideoImage(msg.data);\n          console.log(`Received message`);\n          console.log(msg.timestamp);\n          };\n\n        reader.readAsArrayBuffer(message.data);\n\n      }\n      catch (e) {\n        console.log(`Failed to deserialise websocket message`)\n      }\n}","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/network/selectors.js",["80","81"],"import { selectorFamily, selector } from \"recoil\";\nimport { connectionState } from \"./atoms\";\n\n\nexport const connectionConnectSelector = selector({\n    key: 'connection-connect',\n    set: ({set, get}, url) => {\n        \n    }\n})","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/network/atoms.js",["82"],"import { atomFamily, atom } from \"recoil\";\n\nexport const connectionStateIsConnected = atom({\n    key: 'connection-state-is-connected-atom',\n    default: false,\n});\n\nexport const connectionStateWs = atom({\n    key: 'connection-state-ws-atom',\n    default: null,\n});\n\nexport const connectionStateUrl = atom({\n    key: 'connection-state-url-atom',\n    default: 'ws://localhost:9002',\n});\n\n","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/hooks/useWebsockets.js",["83"],"import { useEffect } from 'react';\nimport { useRecoilState, useSetRecoilState } from 'recoil';\nimport { connectionStateIsConnected, connectionStateWs } from '../state/network'\nimport { videoImage, videoImageParams } from '../state/video'\nimport BSON from 'bson';\n\nexport const useWebsocket = () => {\n\n    const setIsConnected = useSetRecoilState(connectionStateIsConnected);\n    const setVideoImageParams = useSetRecoilState(videoImageParams);\n    const setNewVideoImage = useSetRecoilState(videoImage);\n    const [ws, setWs] = useRecoilState(connectionStateWs);\n\n    useEffect( () => {\n        if(ws) {\n            ws.binaryType = \"blob\";\n\n            ws.onopen = (e) => {\n                setIsConnected(true);\n                console.log(\"WebSocket is connected.\");\n            };\n\n            ws.onclose = (e) => {\n                setIsConnected(false);\n                console.log(\"WebSocket is disconnected.\");\n                setWs(null);\n            };\n\n            ws.onmessage = (message) => {\n                const reader = new FileReader()\n                reader.onload = function () {\n                    const msgarray = new Uint8Array(this.result)\n                    const msg = BSON.deserialize(msgarray)\n                    // console.log(`Received message`);\n                    // console.log(msg.timestamp);\n\n                    let imageParams = {};\n                    imageParams.height = msg.height;\n                    imageParams.width = msg.width;\n                    imageParams.channels = msg.channels;\n\n                    // console.log(\"image pixel:\", msg);\n                    setNewVideoImage(msg.image.buffer);\n                    setVideoImageParams(imageParams);\n                };\n        \n                try {\n                    reader.readAsArrayBuffer(message.data);\n                }\n                catch (e) {\n                    // console.log(`Failed to deserialise websocket message`);\n                    console.log(e);\n                }\n            };\n\n            ws.onerror = (err) => {\n                console.error(\"WebSocket error observed:\", err);\n            };\n        };\n\n    },[ws]);\n\n    return null\n}\n\nexport default useWebsocket;","/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/video/index.js",[],"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/video/selectors.js",[],"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/state/video/atoms.js",["84"],"import { atomFamily, atom } from \"recoil\";\n\nexport const videoImage = atom({\n    key: 'video-image-atom',\n    default: null,\n});\n\nexport const videoImageParams = atom({\n    key: 'video-image-params-atom',\n    default: {\n        height: 480,\n        width: 848,\n        channels: 1,\n    },\n});\n\n",["85","86"],"/home/serhiy/github/jetracer-orbslam2/CarDriver/src/components/videofeed.jsx",["87","88","89"],"import React, { useState, useEffect, useRef } from 'react';\nimport { useRecoilValue } from 'recoil';\nimport { videoImage, videoImageParams } from \"../state/video\";\nimport { connectionStateIsConnected } from '../state/network'\n\n\nexport const VideoFeed = (props) => {\n\n    const currVideoImage = useRecoilValue(videoImage);\n    const currVideoImageParams = useRecoilValue(videoImageParams);\n    const isConnected = useRecoilValue(connectionStateIsConnected);\n\n    const canvasRef = useRef(null);\n\n    useEffect(() => {\n        const canvas = canvasRef.current;\n        canvas.width = currVideoImageParams.width;\n        canvas.height = currVideoImageParams.height;\n        const context = canvas.getContext('2d');\n        //Our first draw\n        context.fillStyle = '#000000';\n        context.fillRect(0, 0, context.canvas.width, context.canvas.height);\n    }, []);\n    \n    useEffect(() => {\n\n        if (isConnected){\n            const imageSize = currVideoImageParams.height * currVideoImageParams.width;\n            const clampedImage = new Uint8ClampedArray(imageSize * 4);\n            for (let i=0; i < imageSize; i++) {\n                clampedImage[i*4] = currVideoImage[i];\n                clampedImage[i*4+1] = currVideoImage[i];\n                clampedImage[i*4+2] = currVideoImage[i];\n                clampedImage[i*4+3] = 255;\n            };\n            const imgData = new ImageData(clampedImage, currVideoImageParams.width, currVideoImageParams.height);\n    \n            const canvas = canvasRef.current;\n            canvas.width = currVideoImageParams.width;\n            canvas.height = currVideoImageParams.height;\n            const context = canvas.getContext('2d');\n            context.putImageData(imgData, 0, 0); \n            // context.putImageData(imgData, 0, 0, 0, 0, currVideoImageParams.width, currVideoImageParams.height); \n            // console.log(\"Draw new image, pixel:\", currVideoImage[848*200 + 200]);   \n        }\n    }, [currVideoImage]);\n\n    return (\n        <div>\n            {/* {isConnected ? <canvas ref={canvasRef} {...props} style={{width: \"100%\"}} /> : \"\"} */}\n            <canvas ref={canvasRef} {...props} />\n        </div>\n    )\n}",{"ruleId":"90","replacedBy":"91"},{"ruleId":"92","replacedBy":"93"},{"ruleId":"94","severity":1,"message":"95","line":16,"column":10,"nodeType":"96","messageId":"97","endLine":16,"endColumn":26},{"ruleId":"90","replacedBy":"98"},{"ruleId":"92","replacedBy":"99"},{"ruleId":"94","severity":1,"message":"100","line":1,"column":17,"nodeType":"96","messageId":"97","endLine":1,"endColumn":25},{"ruleId":"94","severity":1,"message":"101","line":1,"column":27,"nodeType":"96","messageId":"97","endLine":1,"endColumn":36},{"ruleId":"90","replacedBy":"102"},{"ruleId":"92","replacedBy":"103"},{"ruleId":"94","severity":1,"message":"104","line":7,"column":12,"nodeType":"96","messageId":"97","endLine":7,"endColumn":22},{"ruleId":"94","severity":1,"message":"105","line":1,"column":10,"nodeType":"96","messageId":"97","endLine":1,"endColumn":24},{"ruleId":"94","severity":1,"message":"106","line":2,"column":10,"nodeType":"96","messageId":"97","endLine":2,"endColumn":25},{"ruleId":"94","severity":1,"message":"107","line":1,"column":10,"nodeType":"96","messageId":"97","endLine":1,"endColumn":20},{"ruleId":"108","severity":1,"message":"109","line":61,"column":7,"nodeType":"110","endLine":61,"endColumn":11,"suggestions":"111"},{"ruleId":"94","severity":1,"message":"107","line":1,"column":10,"nodeType":"96","messageId":"97","endLine":1,"endColumn":20},{"ruleId":"90","replacedBy":"112"},{"ruleId":"92","replacedBy":"113"},{"ruleId":"94","severity":1,"message":"100","line":1,"column":17,"nodeType":"96","messageId":"97","endLine":1,"endColumn":25},{"ruleId":"108","severity":1,"message":"114","line":23,"column":8,"nodeType":"110","endLine":23,"endColumn":10,"suggestions":"115"},{"ruleId":"108","severity":1,"message":"116","line":46,"column":8,"nodeType":"110","endLine":46,"endColumn":24,"suggestions":"117"},"no-native-reassign",["118"],"no-negated-in-lhs",["119"],"no-unused-vars","'windowDimensions' is assigned a value but never used.","Identifier","unusedVar",["118"],["119"],"'useState' is defined but never used.","'useEffect' is defined but never used.",["118"],["119"],"'videoImage' is assigned a value but never used.","'selectorFamily' is defined but never used.","'connectionState' is defined but never used.","'atomFamily' is defined but never used.","react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'setIsConnected', 'setNewVideoImage', 'setVideoImageParams', and 'setWs'. Either include them or remove the dependency array.","ArrayExpression",["120"],["118"],["119"],"React Hook useEffect has missing dependencies: 'currVideoImageParams.height' and 'currVideoImageParams.width'. Either include them or remove the dependency array.",["121"],"React Hook useEffect has missing dependencies: 'currVideoImageParams.height', 'currVideoImageParams.width', and 'isConnected'. Either include them or remove the dependency array.",["122"],"no-global-assign","no-unsafe-negation",{"desc":"123","fix":"124"},{"desc":"125","fix":"126"},{"desc":"127","fix":"128"},"Update the dependencies array to be: [setIsConnected, setNewVideoImage, setVideoImageParams, setWs, ws]",{"range":"129","text":"130"},"Update the dependencies array to be: [currVideoImageParams.height, currVideoImageParams.width]",{"range":"131","text":"132"},"Update the dependencies array to be: [currVideoImage, currVideoImageParams.height, currVideoImageParams.width, isConnected]",{"range":"133","text":"134"},[2139,2143],"[setIsConnected, setNewVideoImage, setVideoImageParams, setWs, ws]",[860,862],"[currVideoImageParams.height, currVideoImageParams.width]",[1954,1970],"[currVideoImage, currVideoImageParams.height, currVideoImageParams.width, isConnected]"]